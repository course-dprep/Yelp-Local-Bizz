# Load necessary libraries
library(readr)
library(dplyr)
# Define the Google Drive file ID and create the URL
yelp_id <- "1_zEeMXNrsxDwcHfCTYxrba66eygPL0r_"
yelp_url <- paste0("https://drive.google.com/uc?id=", yelp_id)
# Read the CSV file into a dataframe
yelp_data <- read_csv(yelp_url)
# Check unique user types
unique(yelp_data$user_type)
View(yelp_data)
summary_stats <- yelp_data %>%
group_by(elite_binary) %>%
summarize(mean_rating = mean(stars_users), sd_rating = sd(stars_users), count = n())
print(summary_stats)
ggplot(yelp_data, aes(x = factor(elite_binary), y = stars_users)) +
geom_boxplot() +
labs(x = "User Type (0 = Non-Elite, 1 = Elite)", y = "Rating", title = "Distribution of Ratings by User Type")
library(ggplot2)
ggplot(yelp_data, aes(x = factor(elite_binary), y = stars_users)) +
geom_boxplot() +
labs(x = "User Type (0 = Non-Elite, 1 = Elite)", y = "Rating", title = "Distribution of Ratings by User Type")
t_test_result <- t.test(stars_users ~ elite_binary, data = yelp_data)
print(t_test_result)
correlation <- cor(yelp_data$elite_binary, yelp_data$stars_users)
print(paste("Pearson correlation coefficient:", correlation))
yelp_data <- yelp_data %>%
mutate(interaction_term = elite_binary * fans)
# Fit the regression model
model <- lm(stars_users ~ elite_binary + fans + interaction_term, data = yelp_data)
# Summarize the model
summary(model)
ggplot(yelp_data, aes(x = fans, y = stars_users, color = factor(elite_binary))) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", aes(group = elite_binary), se = FALSE) +
labs(x = "Number of Fans", y = "Rating", color = "User Type (0 = Non-Elite, 1 = Elite)", title = "Interaction Effect of User Type and Number of Fans on Ratings")
interaction_p_value <- summary(model)$coefficients["interaction_term", "Pr(>|t|)"]
print(paste("P-value for the interaction term:", interaction_p_value))
ggplot(yelp_data, aes(x = fans, y = average_stars, color = factor(elite_binary))) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", aes(group = elite_binary), se = FALSE) +
labs(x = "Number of Fans", y = "Rating", color = "User Type (0 = Non-Elite, 1 = Elite)", title = "Interaction Effect of User Type and Number of Fans on Ratings")
